<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŠ¨ç”»åœ£è¯æ ‘</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: linear-gradient(to bottom, #001122, #003344);
            color: white;
            font-family: 'Arial', sans-serif;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow-x: hidden;
            padding: 20px;
        }
        
        .container {
            text-align: center;
            max-width: 800px;
            width: 100%;
            padding: 20px;
        }
        
        h1 {
            color: #ff4444;
            margin-bottom: 10px;
            font-size: 2.5rem;
            text-shadow: 0 0 10px rgba(255, 68, 68, 0.5);
        }
        
        .subtitle {
            color: #44ff88;
            margin-bottom: 30px;
            font-size: 1.2rem;
        }
        
        .tree-container {
            position: relative;
            margin: 30px auto;
            width: 400px;
            height: 600px;
        }
        
        .tree {
            position: absolute;
            width: 100%;
            height: 100%;
        }
        
        /* æ ‘å¹² */
        .trunk {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 40px;
            height: 120px;
            background: linear-gradient(to right, #8B4513, #A0522D, #8B4513);
            border-radius: 5px;
        }
        
        /* æ ‘å† å±‚çº§ */
        .layer {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            background: linear-gradient(to bottom, #0a5f0a, #0c8c0c, #0a5f0a);
            box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.3);
        }
        
        .layer-1 {
            width: 320px;
            height: 120px;
            bottom: 120px;
            z-index: 3;
        }
        
        .layer-2 {
            width: 260px;
            height: 110px;
            bottom: 210px;
            z-index: 2;
        }
        
        .layer-3 {
            width: 200px;
            height: 100px;
            bottom: 290px;
            z-index: 1;
        }
        
        .layer-4 {
            width: 140px;
            height: 90px;
            bottom: 360px;
            z-index: 0;
        }
        
        /* æ ‘é¡¶æ˜Ÿæ˜Ÿ */
        .star {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            bottom: 450px;
            width: 60px;
            height: 60px;
            background: gold;
            clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
            z-index: 4;
            animation: star-glow 2s infinite alternate;
            box-shadow: 0 0 20px gold;
        }
        
        @keyframes star-glow {
            0% { opacity: 0.8; transform: translateX(-50%) scale(1); }
            100% { opacity: 1; transform: translateX(-50%) scale(1.1); }
        }
        
        /* è£…é¥°ç¯ */
        .light {
            position: absolute;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            z-index: 5;
            animation: light-blink 1.5s infinite alternate;
        }
        
        @keyframes light-blink {
            0% { opacity: 0.6; transform: scale(1); }
            100% { opacity: 1; transform: scale(1.2); }
        }
        
        /* é›ªèŠ± */
        .snow {
            position: absolute;
            background-color: white;
            border-radius: 50%;
            opacity: 0.8;
            filter: blur(1px);
            animation: snowfall linear infinite;
        }
        
        @keyframes snowfall {
            0% { transform: translateY(-100px) rotate(0deg); }
            100% { transform: translateY(600px) rotate(360deg); }
        }
        
        /* ç¤¼ç‰©ç›’å­ */
        .gifts {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 350px;
            height: 80px;
            display: flex;
            justify-content: center;
            gap: 20px;
            z-index: 10;
        }
        
        .gift {
            width: 60px;
            height: 60px;
            position: relative;
            animation: gift-bounce 3s infinite alternate;
        }
        
        .gift:nth-child(1) { background-color: #ff4444; animation-delay: 0s; }
        .gift:nth-child(2) { background-color: #44ff88; animation-delay: 0.5s; }
        .gift:nth-child(3) { background-color: #4488ff; animation-delay: 1s; }
        .gift:nth-child(4) { background-color: #ffaa44; animation-delay: 1.5s; }
        .gift:nth-child(5) { background-color: #aa44ff; animation-delay: 2s; }
        
        .gift::before {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 20px;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.3);
        }
        
        .gift::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            transform: translateY(-50%);
            width: 100%;
            height: 20px;
            background-color: rgba(255, 255, 255, 0.3);
        }
        
        @keyframes gift-bounce {
            0% { transform: translateY(0); }
            100% { transform: translateY(-20px); }
        }
        
        /* æ§åˆ¶é¢æ¿ */
        .controls {
            background-color: rgba(0, 20, 40, 0.7);
            border-radius: 15px;
            padding: 20px;
            margin-top: 30px;
            width: 100%;
            max-width: 500px;
            box-shadow: 0 0 20px rgba(0, 100, 200, 0.3);
        }
        
        .control-group {
            margin-bottom: 15px;
            text-align: left;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            color: #44ffaa;
        }
        
        input[type="range"] {
            width: 100%;
            height: 10px;
            -webkit-appearance: none;
            background: linear-gradient(to right, #0a5f0a, #44ff88);
            border-radius: 5px;
            outline: none;
        }
        
        .buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }
        
        button {
            background: linear-gradient(to bottom, #ff4444, #cc0000);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            transition: all 0.3s;
            box-shadow: 0 4px 0 #880000;
        }
        
        button:hover {
            background: linear-gradient(to bottom, #ff6666, #dd2222);
            transform: translateY(-2px);
            box-shadow: 0 6px 0 #880000;
        }
        
        button:active {
            transform: translateY(2px);
            box-shadow: 0 2px 0 #880000;
        }
        
        .instructions {
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            margin-top: 30px;
            font-size: 0.9rem;
            line-height: 1.5;
            max-width: 600px;
        }
        
        .share-link {
            background-color: rgba(0, 40, 80, 0.8);
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
            font-size: 0.9rem;
            word-break: break-all;
        }
        
        .share-link span {
            color: #44ffaa;
            font-weight: bold;
        }
        
        footer {
            margin-top: 30px;
            color: #88aaff;
            font-size: 0.9rem;
            text-align: center;
        }
        
        @media (max-width: 600px) {
            .tree-container {
                width: 300px;
                height: 500px;
            }
            
            .layer-1 { width: 240px; }
            .layer-2 { width: 200px; }
            .layer-3 { width: 160px; }
            .layer-4 { width: 120px; }
            
            h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>âœ¨ åŠ¨ç”»åœ£è¯æ ‘ ğŸ„</h1>
        <p class="subtitle">ç¥ä½ åœ£è¯å¿«ä¹ï¼è°ƒèŠ‚ä¸‹é¢çš„è®¾ç½®æ¥å®šåˆ¶ä½ çš„åœ£è¯æ ‘</p>
        
        <div class="tree-container">
            <!-- åœ£è¯æ ‘å°†åœ¨è¿™é‡Œé€šè¿‡JavaScriptç”Ÿæˆ -->
        </div>
        
        <div class="controls">
            <div class="control-group">
                <label for="speed">åŠ¨ç”»é€Ÿåº¦: <span id="speed-value">ä¸­</span></label>
                <input type="range" id="speed" min="1" max="5" value="3">
            </div>
            
            <div class="control-group">
                <label for="lights">å½©ç¯æ•°é‡: <span id="lights-value">20</span></label>
                <input type="range" id="lights" min="5" max="40" value="20">
            </div>
            
            <div class="control-group">
                <label for="snow">é›ªèŠ±å¯†åº¦: <span id="snow-value">ä¸­</span></label>
                <input type="range" id="snow" min="1" max="5" value="3">
            </div>
            
            <div class="buttons">
                <button id="play-pause">æš‚åœåŠ¨ç”»</button>
                <button id="reset">é‡ç½®è®¾ç½®</button>
                <button id="randomize">éšæœºå½©ç¯</button>
            </div>
        </div>
        
        <div class="instructions">
            <h3>ä½¿ç”¨è¯´æ˜ï¼š</h3>
            <p>1. ä½¿ç”¨æ»‘å—è°ƒèŠ‚åŠ¨ç”»é€Ÿåº¦ã€å½©ç¯æ•°é‡å’Œé›ªèŠ±å¯†åº¦</p>
            <p>2. ç‚¹å‡»"æš‚åœåŠ¨ç”»"æŒ‰é’®å¯ä»¥æš‚åœ/ç»§ç»­åŠ¨ç”»</p>
            <p>3. ç‚¹å‡»"éšæœºå½©ç¯"å¯ä»¥éšæœºæ”¹å˜å½©ç¯é¢œè‰²</p>
            <p>4. ç‚¹å‡»"é‡ç½®è®¾ç½®"å¯ä»¥æ¢å¤é»˜è®¤è®¾ç½®</p>
        </div>
        
        <div class="share-link">
            <p>è¦åˆ†äº«è¿™ä¸ªåœ£è¯æ ‘ï¼Œè¯·å°†ä»¥ä¸‹é“¾æ¥å‘é€ç»™æœ‹å‹ï¼š</p>
            <p><span id="share-url">åŠ è½½ä¸­...</span></p>
            <p>ç¡®ä¿ä½ çš„ç”µè„‘å’Œæœ‹å‹çš„è®¾å¤‡åœ¨åŒä¸€ç½‘ç»œä¸­</p>
        </div>
        
        <footer>
            <p>ä½¿ç”¨HTML5ã€CSS3å’ŒJavaScriptåˆ›å»ºçš„åŠ¨ç”»åœ£è¯æ ‘ | ç¥ä½ åœ£è¯å¿«ä¹ï¼ğŸ…ğŸ</p>
        </footer>
    </div>

    <script>
        // è·å–DOMå…ƒç´ 
        const treeContainer = document.querySelector('.tree-container');
        const speedSlider = document.getElementById('speed');
        const speedValue = document.getElementById('speed-value');
        const lightsSlider = document.getElementById('lights');
        const lightsValue = document.getElementById('lights-value');
        const snowSlider = document.getElementById('snow');
        const snowValue = document.getElementById('snow-value');
        const playPauseBtn = document.getElementById('play-pause');
        const resetBtn = document.getElementById('reset');
        const randomizeBtn = document.getElementById('randomize');
        const shareUrl = document.getElementById('share-url');
        
        // åŠ¨ç”»çŠ¶æ€
        let animationPlaying = true;
        let lights = [];
        let snowflakes = [];
        
        // é€Ÿåº¦æ˜ å°„
        const speedMap = {
            1: "å¾ˆæ…¢",
            2: "æ…¢",
            3: "ä¸­",
            4: "å¿«",
            5: "å¾ˆå¿«"
        };
        
        // é›ªèŠ±å¯†åº¦æ˜ å°„
        const snowMap = {
            1: "å¾ˆå°‘",
            2: "å°‘",
            3: "ä¸­",
            4: "å¤š",
            5: "å¾ˆå¤š"
        };
        
        // åˆå§‹åŒ–åœ£è¯æ ‘
        function initTree() {
            // æ¸…ç©ºå®¹å™¨
            treeContainer.innerHTML = '';
            
            // åˆ›å»ºæ ‘å…ƒç´ 
            const tree = document.createElement('div');
            tree.className = 'tree';
            
            // æ·»åŠ æ ‘å¹²
            const trunk = document.createElement('div');
            trunk.className = 'trunk';
            tree.appendChild(trunk);
            
            // æ·»åŠ æ ‘å† å±‚çº§
            const layer1 = document.createElement('div');
            layer1.className = 'layer layer-1';
            tree.appendChild(layer1);
            
            const layer2 = document.createElement('div');
            layer2.className = 'layer layer-2';
            tree.appendChild(layer2);
            
            const layer3 = document.createElement('div');
            layer3.className = 'layer layer-3';
            tree.appendChild(layer3);
            
            const layer4 = document.createElement('div');
            layer4.className = 'layer layer-4';
            tree.appendChild(layer4);
            
            // æ·»åŠ æ ‘é¡¶æ˜Ÿæ˜Ÿ
            const star = document.createElement('div');
            star.className = 'star';
            tree.appendChild(star);
            
            // æ·»åŠ ç¤¼ç‰©ç›’å­
            const gifts = document.createElement('div');
            gifts.className = 'gifts';
            
            for (let i = 0; i < 5; i++) {
                const gift = document.createElement('div');
                gift.className = 'gift';
                gifts.appendChild(gift);
            }
            
            tree.appendChild(gifts);
            
            // å°†æ ‘æ·»åŠ åˆ°å®¹å™¨
            treeContainer.appendChild(tree);
            
            // åˆ›å»ºå½©ç¯
            createLights();
            
            // åˆ›å»ºé›ªèŠ±
            createSnowflakes();
            
            // æ›´æ–°åˆ†äº«é“¾æ¥
            updateShareUrl();
        }
        
        // åˆ›å»ºå½©ç¯
        function createLights() {
            // æ¸…é™¤ç°æœ‰çš„å½©ç¯
            lights.forEach(light => {
                if (light.element && light.element.parentNode) {
                    light.element.parentNode.removeChild(light.element);
                }
            });
            
            lights = [];
            
            const lightCount = parseInt(lightsSlider.value);
            const lightColors = ['#ff4444', '#44ff88', '#4488ff', '#ffff44', '#ff44ff', '#44ffff', '#ff8844'];
            
            // å½©ç¯ä½ç½®ï¼ˆæ¨¡æ‹Ÿåœ¨æ ‘ä¸Šï¼‰
            const positions = [
                // åº•å±‚
                {bottom: '130px', left: '30%'},
                {bottom: '130px', left: '70%'},
                {bottom: '150px', left: '40%'},
                {bottom: '150px', left: '60%'},
                {bottom: '170px', left: '35%'},
                {bottom: '170px', left: '65%'},
                {bottom: '190px', left: '45%'},
                {bottom: '190px', left: '55%'},
                {bottom: '210px', left: '50%'},
                
                // ä¸­å±‚
                {bottom: '230px', left: '35%'},
                {bottom: '230px', left: '65%'},
                {bottom: '250px', left: '40%'},
                {bottom: '250px', left: '60%'},
                {bottom: '270px', left: '45%'},
                {bottom: '270px', left: '55%'},
                {bottom: '290px', left: '50%'},
                
                // ä¸Šå±‚
                {bottom: '310px', left: '40%'},
                {bottom: '310px', left: '60%'},
                {bottom: '330px', left: '45%'},
                {bottom: '330px', left: '55%'},
                {bottom: '350px', left: '50%'},
                
                // é¡¶å±‚
                {bottom: '380px', left: '48%'},
                {bottom: '400px', left: '52%'},
                {bottom: '420px', left: '49%'}
            ];
            
            // åˆ›å»ºå½©ç¯
            const tree = document.querySelector('.tree');
            for (let i = 0; i < Math.min(lightCount, positions.length); i++) {
                const light = document.createElement('div');
                light.className = 'light';
                
                // éšæœºé€‰æ‹©é¢œè‰²
                const color = lightColors[Math.floor(Math.random() * lightColors.length)];
                light.style.backgroundColor = color;
                light.style.boxShadow = `0 0 10px ${color}`;
                
                // è®¾ç½®ä½ç½®
                light.style.bottom = positions[i].bottom;
                light.style.left = positions[i].left;
                
                // éšæœºåŠ¨ç”»å»¶è¿Ÿ
                light.style.animationDelay = `${Math.random() * 2}s`;
                
                // æ·»åŠ åˆ°æ ‘å’Œlightsæ•°ç»„
                tree.appendChild(light);
                lights.push({
                    element: light,
                    color: color,
                    position: positions[i]
                });
            }
        }
        
        // åˆ›å»ºé›ªèŠ±
        function createSnowflakes() {
            // æ¸…é™¤ç°æœ‰çš„é›ªèŠ±
            snowflakes.forEach(snowflake => {
                if (snowflake.element && snowflake.element.parentNode) {
                    snowflake.element.parentNode.removeChild(snowflake.element);
                }
            });
            
            snowflakes = [];
            
            const snowDensity = parseInt(snowSlider.value);
            const snowCount = snowDensity * 15;
            
            // åˆ›å»ºé›ªèŠ±
            for (let i = 0; i < snowCount; i++) {
                const snowflake = document.createElement('div');
                snowflake.className = 'snow';
                
                // éšæœºå¤§å°
                const size = Math.random() * 8 + 2;
                snowflake.style.width = `${size}px`;
                snowflake.style.height = `${size}px`;
                
                // éšæœºä½ç½®
                const left = Math.random() * 100;
                snowflake.style.left = `${left}%`;
                
                // éšæœºé€æ˜åº¦
                snowflake.style.opacity = Math.random() * 0.5 + 0.3;
                
                // éšæœºåŠ¨ç”»
                const duration = Math.random() * 10 + 10; // 10-20ç§’
                const delay = Math.random() * 5; // 0-5ç§’å»¶è¿Ÿ
                snowflake.style.animationDuration = `${duration}s`;
                snowflake.style.animationDelay = `${delay}s`;
                
                // æ·»åŠ åˆ°é¡µé¢å’Œæ•°ç»„
                document.body.appendChild(snowflake);
                snowflakes.push({
                    element: snowflake,
                    left: left,
                    size: size
                });
            }
        }
        
        // æ›´æ–°åŠ¨ç”»é€Ÿåº¦
        function updateSpeed() {
            const speed = parseInt(speedSlider.value);
            speedValue.textContent = speedMap[speed];
            
            // è°ƒæ•´æ‰€æœ‰åŠ¨ç”»çš„é€Ÿåº¦
            const speedFactor = speed / 3; // ä»¥3ä¸ºåŸºå‡†
            
            // è°ƒæ•´å½©ç¯åŠ¨ç”»é€Ÿåº¦
            lights.forEach(light => {
                light.element.style.animationDuration = `${1.5 / speedFactor}s`;
            });
            
            // è°ƒæ•´é›ªèŠ±åŠ¨ç”»é€Ÿåº¦
            snowflakes.forEach(snowflake => {
                const originalDuration = parseFloat(snowflake.element.style.animationDuration);
                snowflake.element.style.animationDuration = `${originalDuration / speedFactor}s`;
            });
            
            // è°ƒæ•´æ˜Ÿæ˜ŸåŠ¨ç”»é€Ÿåº¦
            const star = document.querySelector('.star');
            star.style.animationDuration = `${2 / speedFactor}s`;
            
            // è°ƒæ•´ç¤¼ç‰©åŠ¨ç”»é€Ÿåº¦
            const gifts = document.querySelectorAll('.gift');
            gifts.forEach((gift, index) => {
                gift.style.animationDuration = `${3 / speedFactor}s`;
            });
        }
        
        // éšæœºåŒ–å½©ç¯é¢œè‰²
        function randomizeLights() {
            const lightColors = ['#ff4444', '#44ff88', '#4488ff', '#ffff44', '#ff44ff', '#44ffff', '#ff8844'];
            
            lights.forEach(light => {
                const newColor = lightColors[Math.floor(Math.random() * lightColors.length)];
                light.element.style.backgroundColor = newColor;
                light.element.style.boxShadow = `0 0 10px ${newColor}`;
                light.color = newColor;
            });
        }
        
        // æ’­æ”¾/æš‚åœåŠ¨ç”»
        function toggleAnimation() {
            animationPlaying = !animationPlaying;
            
            if (animationPlaying) {
                // æ¢å¤æ‰€æœ‰åŠ¨ç”»
                playPauseBtn.textContent = 'æš‚åœåŠ¨ç”»';
                document.querySelectorAll('*').forEach(el => {
                    if (el.style.animationPlayState === 'paused') {
                        el.style.animationPlayState = 'running';
                    }
                });
            } else {
                // æš‚åœæ‰€æœ‰åŠ¨ç”»
                playPauseBtn.textContent = 'æ’­æ”¾åŠ¨ç”»';
                document.querySelectorAll('*').forEach(el => {
                    if (window.getComputedStyle(el).animationName !== 'none') {
                        el.style.animationPlayState = 'paused';
                    }
                });
            }
        }
        
        // é‡ç½®è®¾ç½®
        function resetSettings() {
            speedSlider.value = 3;
            lightsSlider.value = 20;
            snowSlider.value = 3;
            
            speedValue.textContent = speedMap[3];
            lightsValue.textContent = 20;
            snowValue.textContent = snowMap[3];
            
            createLights();
            createSnowflakes();
            updateSpeed();
            
            if (!animationPlaying) {
                toggleAnimation();
            }
        }
        
        // æ›´æ–°åˆ†äº«é“¾æ¥
        function updateShareUrl() {
            // è·å–å½“å‰IPåœ°å€
            fetch('https://api.ipify.org?format=json')
                .then(response => response.json())
                .then(data => {
                    shareUrl.textContent = `http://${data.ip}:8000`;
                })
                .catch(() => {
                    // å¦‚æœæ— æ³•è·å–å¤–éƒ¨IPï¼Œæ˜¾ç¤ºæœ¬åœ°IP
                    shareUrl.textContent = "http://localhost:8000 æˆ– http://[ä½ çš„IPåœ°å€]:8000";
                });
        }
        
        // äº‹ä»¶ç›‘å¬å™¨
        speedSlider.addEventListener('input', function() {
            speedValue.textContent = speedMap[this.value];
            updateSpeed();
        });
        
        lightsSlider.addEventListener('input', function() {
            lightsValue.textContent = this.value;
            createLights();
            updateSpeed();
        });
        
        snowSlider.addEventListener('input', function() {
            snowValue.textContent = snowMap[this.value];
            createSnowflakes();
            updateSpeed();
        });
        
        playPauseBtn.addEventListener('click', toggleAnimation);
        
        resetBtn.addEventListener('click', resetSettings);
        
        randomizeBtn.addEventListener('click', randomizeLights);
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initTree();
            updateSpeed();
        });
        
        // çª—å£å¤§å°æ”¹å˜æ—¶è°ƒæ•´
        window.addEventListener('resize', function() {
            // å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ å“åº”å¼è°ƒæ•´
        });
    </script>
</body>
</html>